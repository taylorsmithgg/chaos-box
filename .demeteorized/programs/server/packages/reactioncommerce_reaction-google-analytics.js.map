{"version":3,"sources":["reactioncommerce:reaction-google-analytics/common/register.coffee","reactioncommerce:reaction-google-analytics/common/collections.coffee","reactioncommerce:reaction-google-analytics/server/security/AnalyticsEvents.coffee","reactioncommerce:reaction-google-analytics/server/publications.coffee","reactioncommerce:reaction-google-analytics/server/fixtures.coffee"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,YAAY,CAAC,eAAb,CACE;AAAA,QAAM,2BAAN;AAAA,EACA,UAAU,CAAC,WAAD,CADV;AAAA,EAEA,OAAO,kBAFP;AAAA,EAGA,aAAa,sCAHb;AAAA,EAIA,MAAM,mBAJN;AAAA,EAKA,eAAe,2BALf;AAAA,EAMA,WAAW,KANX;AAAA,EAOA,UAAU,GAPV;AAAA,EAQA,YAAY,IARZ;AAAA,EASA,iBAAiB;IACf;AAAA,MACE,OAAO,kBADT;AAAA,MAEE,YAAY,oBAFd;AAAA,MAGE,OAAO,eAHT;KADe;GATjB;CADF;;;;;;;;;;;;;;;;;;;ACAA,YAAY,CAAC,WAAW,CAAC,eAAzB,GAA+C,UAAM,CAAC,UAAP,CAAkB,iBAAlB,CAA/C;;;;;;;;;;;;;;;;;;;ACAA,YAAY,CAAC,WAAW,CAAC,eAAe,CAAC,KAAzC,CACE;AAAA,UAAQ,SAAC,MAAD,EAAS,cAAT;AACN,kBAAc,CAAC,MAAf,GAAwB,YAAY,CAAC,SAAb,EAAxB;AACA,WAAO,IAAP,CAFM;EAAA,CAAR;AAAA,EAGA,QAAQ,SAAC,MAAD,EAAS,cAAT,EAAyB,MAAzB,EAAiC,QAAjC;AACN,QAAG,QAAQ,CAAC,IAAT,IAAiB,QAAQ,CAAC,IAAI,CAAC,MAAlC;AACE,aAAO,KAAP,CADF;KAAA;AAEA,WAAO,IAAP,CAHM;EAAA,CAHR;AAAA,EAOA,QAAQ,SAAC,MAAD,EAAS,cAAT;AACN,QAAG,cAAc,CAAC,MAAf,KAAyB,YAAY,CAAC,SAAb,EAA5B;AACE,aAAO,KAAP,CADF;KAAA;AAEA,WAAO,IAAP,CAHM;EAAA,CAPR;CADF;;;;;;;;;;;;;;;;;;;ACAA,MAAM,CAAC,OAAP,CAAe,iBAAf,EAAkC;AAChC,SAAO,YAAY,CAAC,WAAW,CAAC,eAAe,CAAC,IAAzC,CAA8C;AAAA,YAAQ,YAAY,CAAC,SAAb,CAAuB,IAAvB,CAAR;GAA9C,CAAP,CADgC;AAAA,CAAlC;;;;;;;;;;;;;;;;;;;ACAA;AAAA;;GAAA;AAAA;;AAAA,QAGA,GAAW,YAAY,CAAC,WAAW,CAAC,QAHpC;;AAAA,MAIM,CAAC,OAAP,CAAe;AACb;AAAA,gDAAsB,CAAE,gCAAxB;AACA;AAAA;GADA;SAKA,QAAQ,CAAC,MAAT,CAAgB;AAAA,IAAC,MAAK,2BAAN;AAAA,IAAmC,UAAU,IAA7C;GAAhB,EACE;AAAA,IAAC,MAAM;AAAA,MAAC,UAAU,IAAX;KAAP;GADF,EAEE,SAAC,KAAD,EAAQ,MAAR;AACE,QAAG,SAAS,CAAZ;aACE,YAAY,CAAC,MAAM,CAAC,IAApB,CAAyB,sCAAzB,EAAiE,IAAjE,EADF;KADF;EAAA,CAFF,EANa;AAAA,CAAf,CAJA","file":"/packages/reactioncommerce:reaction-google-analytics.js","sourcesContent":["ReactionCore.registerPackage\n  name: \"reaction-google-analytics\"\n  provides: ['analytics']\n  label: \"Google Analytics\"\n  description: \"Event tracking with Google Analytics\"\n  icon: \"fa fa-bar-chart-o\"\n  settingsRoute: \"dashboard/settings/google\"\n  hasWidget: false\n  priority: \"4\"\n  autoEnable: true\n  shopPermissions: [\n    {\n      label: \"Google Analytics\"\n      permission: \"dashboard/settings\"\n      group: \"Shop Settings\"\n    }\n  ]","ReactionCore.Collections.AnalyticsEvents = new Meteor.Collection \"AnalyticsEvents\"\n","ReactionCore.Collections.AnalyticsEvents.allow\n  insert: (userId, analyticsEvent) ->\n    analyticsEvent.shopId = ReactionCore.getShopId()\n    return true\n  update: (userId, analyticsEvent, fields, modifier) ->\n    if modifier.$set && modifier.$set.shopId\n      return false\n    return true\n  remove: (userId, analyticsEvent) ->\n    if analyticsEvent.shopId != ReactionCore.getShopId()\n      return false\n    return true\n","Meteor.publish \"AnalyticsEvents\", ->\n  return ReactionCore.Collections.AnalyticsEvents.find shopId: ReactionCore.getShopId(@)\n","###\n# Fixture - we always want a record\n###\nPackages = ReactionCore.Collections.Packages\nMeteor.startup ->\n  prop = Meteor.settings?.googleAnalyticsProperty\n  return unless prop\n  # XXX can we load stuff from Meteor.settings in core, perhaps by using a defined syntax such as\n  # Meteor.settings.pkgName = config\n  # Also, can `property` be merged with `settings`?\n  Packages.update {name:\"reaction-google-analytics\", property: null},\n    {$set: {property: prop}},\n    (error, result) ->\n      if result > 0\n        ReactionCore.Events.info \"Added google analytics fixture data:\", prop"]}